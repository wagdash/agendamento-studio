<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Studio Tay B√©nesse</title>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4}
.page{display:none;padding:20px}
.page.active{display:block}
h1{text-align:center}
button{width:100%;padding:14px;margin-top:15px;border:none;border-radius:12px;background:#000;color:#fff;font-size:16px}
input{width:100%;padding:14px;font-size:18px;border-radius:12px;border:1px solid #ccc;margin-top:10px;text-align:center}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:15px}
.day{padding:12px;text-align:center;border-radius:10px;background:#dff6df}
.day.disabled{background:#ffdede;color:#999}
.day.selected{background:#000;color:#fff}
.nav{display:flex;justify-content:space-between;align-items:center}
.card{background:#fff;padding:15px;border-radius:14px;margin-top:10px}
label{display:block;margin-top:10px;font-size:16px}
.msg{
  display:none;
  background:#ffe9c6;
  color:#7a4b00;
  padding:12px;
  border-radius:10px;
  margin-top:12px;
  font-size:15px;
}
</style>
</head>

<body>

<!-- P√ÅGINA 1 -->
<div class="page active" id="p1">
<h1>Agendamento</h1>

<div class="nav">
<button onclick="prevMonth()">‚óÄ</button>
<strong id="monthYear"></strong>
<button onclick="nextMonth()">‚ñ∂</button>
</div>

<div class="calendar" id="calendar"></div>

<input id="time" placeholder="HH:MM" maxlength="5">

<div class="msg" id="msg1"></div>

<button onclick="goPage(2)">Continuar</button>
</div>

<!-- P√ÅGINA 2 -->
<div class="page" id="p2">
<h1>Procedimentos</h1>

<div class="card">
<label><input type="checkbox" data-time="60" value="Design de Sobrancelhas ‚Äì R$50"> Design de Sobrancelhas</label>
<label><input type="checkbox" data-time="90" value="Limpeza de Pele ‚Äì R$120"> Limpeza de Pele</label>
<label><input type="checkbox" data-time="120" value="Micropigmenta√ß√£o ‚Äì R$300"> Micropigmenta√ß√£o</label>
</div>

<div class="msg" id="msg2"></div>

<button onclick="goPage(3)">Continuar</button>
</div>

<!-- P√ÅGINA 3 -->
<div class="page" id="p3">
<h1>Forma de Pagamento</h1>

<div class="card">
<label><input type="radio" name="pay" value="Pix"> Pix</label>
<label><input type="radio" name="pay" value="Dinheiro"> Dinheiro</label>
</div>

<div class="msg" id="msg3"></div>

<button onclick="goPage(4)">Continuar</button>
</div>

<!-- P√ÅGINA 4 -->
<div class="page" id="p4">
<h1>Resumo</h1>

<div class="card" id="summary"></div>

<button onclick="confirm()">Confirmar Agendamento</button>
</div>

<script>

let date=new Date()
let selectedDate=""
let busy=JSON.parse(localStorage.getItem("busy")||"{}")
let monthLimit=new Date().getMonth()+3

function showMsg(id,text){
  let el=document.getElementById(id)
  el.innerText=text
  el.style.display="block"
}

function hideMsg(id){
  document.getElementById(id).style.display="none"
}

function goPage(n){
  if(n===2 && !validP1()) return
  if(n===3 && !validP2()) return
  if(n===4 && !validP3()) return

  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"))
  document.getElementById("p"+n).classList.add("active")

  if(n===4) buildSummary()
}

function buildCalendar(){
  calendar.innerHTML=""
  monthYear.innerText=date.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})
  let days=new Date(date.getFullYear(),date.getMonth()+1,0).getDate()

  for(let d=1;d<=days;d++){
    let div=document.createElement("div")
    let check=new Date(date.getFullYear(),date.getMonth(),d)
    div.innerText=d
    div.className="day"

    if(check < new Date() || check.getDay()===0){
      div.classList.add("disabled")
    }else{
      div.onclick=()=>{
        document.querySelectorAll(".day").forEach(x=>x.classList.remove("selected"))
        div.classList.add("selected")
        selectedDate=check.toLocaleDateString("pt-BR")
        hideMsg("msg1")
      }
    }
    calendar.appendChild(div)
  }
}

function prevMonth(){
  if(date.getMonth()===new Date().getMonth()) return
  date.setMonth(date.getMonth()-1)
  buildCalendar()
}

function nextMonth(){
  if(date.getMonth()>=monthLimit) return
  date.setMonth(date.getMonth()+1)
  buildCalendar()
}

time.addEventListener("input",e=>{
  let v=e.target.value.replace(/\D/g,"")
  if(v.length>=3) v=v.slice(0,2)+":"+v.slice(2,4)
  e.target.value=v
  hideMsg("msg1")
})

function validP1(){
  if(!selectedDate){showMsg("msg1","Escolha uma data dispon√≠vel.");return false}
  let t=time.value
  if(!/^([0-1]\d|2[0-3]):[0-5]\d$/.test(t)){showMsg("msg1","Digite um hor√°rio v√°lido.");return false}
  if(t<"07:00"||t>"18:00"){showMsg("msg1","Hor√°rio fora do expediente.");return false}
  if(busy[selectedDate]?.includes(t)){showMsg("msg1","Esse hor√°rio j√° foi agendado.");return false}
  return true
}

function validP2(){
  if(!document.querySelector("input[type=checkbox]:checked")){
    showMsg("msg2","Escolha pelo menos um procedimento.")
    return false
  }
  hideMsg("msg2")
  return true
}

function validP3(){
  if(!document.querySelector("input[name=pay]:checked")){
    showMsg("msg3","Escolha a forma de pagamento.")
    return false
  }
  hideMsg("msg3")
  return true
}

function buildSummary(){
  let txt=`<b>Data:</b> ${selectedDate}<br><b>Hor√°rio:</b> ${time.value}<br><br>`
  document.querySelectorAll("input[type=checkbox]:checked").forEach(c=>{
    txt+=`‚Ä¢ ${c.value}<br>`
  })
  txt+=`<br><b>Pagamento:</b> ${document.querySelector("input[name=pay]:checked").value}`
  summary.innerHTML=txt
}

function confirm(){
  busy[selectedDate]=busy[selectedDate]||[]
  busy[selectedDate].push(time.value)
  localStorage.setItem("busy",JSON.stringify(busy))
  document.body.innerHTML="<h2 style='text-align:center;padding:30px'>Agendamento realizado com sucesso üíñ</h2>"
}

buildCalendar()
</script>

</body>
</html>